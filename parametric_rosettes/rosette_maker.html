<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script language="javascript" type="text/javascript" src="../libraries/p5-0.10.2.min.js"></script>
    <script type="module">
      import "./components/CoefficientPicker.js";
      import "./components/CoefficientGrid.js";
      import "./components/ParametricRosetteViewer.js";

      window.addEventListener("load", () => {
        const grid = document.getElementById("coefficient-grid");
        const picker = document.getElementById("coefficient-picker");
        const output = document.getElementById("coefficient");
        const rosette = document.getElementById("rosette");

        grid.addEventListener("coefficient-selected", (e) => {
          picker.coefficient = e.detail;
        });

        picker.addEventListener("change", (e) => {
          const coefficient = e.detail;

          // Display the selected value on the page
          const amp = coefficient.amplitude.toPrecision(2);
          const phase = coefficient.phase.toPrecision(2);
          const real = coefficient.real.toPrecision(2);
          const imag = coefficient.imag.toPrecision(3);
          output.innerHTML = `Amplitude: ${amp}, phase: ${phase}<br/>(${real} + ${imag} i)`;

          // Update the currently selected coefficient
          grid.update_selected([coefficient.amplitude, coefficient.phase]);
        });
      });
    </script>
  </head>
  <body>
    <sym-coefficient-grid
      id="coefficient-grid"
      width="550"
      height="50"
      rows="1"
      cols="11"
      coefficients="1,0,0.8,0.3,0.4,-2.0"
    ></sym-coefficient-grid>
    <sym-coefficient-picker id="coefficient-picker"></sym-coefficient-picker>
    <span id="coefficient"></span>
    <sym-parametric-rosette id="rosette" show-arm="false" preset="3k + 1"></sym-parametric-rosette>
    <sym-parametric-rosette show-arm="true" preset="2k + 1"></sym-parametric-rosette>
  </body>
</html>
