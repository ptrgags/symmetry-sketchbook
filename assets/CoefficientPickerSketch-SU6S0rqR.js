var Y=Object.defineProperty;var H=(i,s,e)=>s in i?Y(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var T=(i,s,e)=>(H(i,typeof s!="symbol"?s+"":s,e),e);import{d as X,r as $,D as j,E as W,f as E,c as z,e as A,F as P,m as K,B as M,s as V,t as J,G as Q,i as Z,C as p,g as ee}from"./index-BgDKrswi.js";import{S as d,a as q}from"./Sketch-Ywa2RNtX.js";const te={class:"headings horizontal"},se=["onClick"],ne={class:"tab-body"},le=X({__name:"TabLayout",setup(i){const s=$([]),e=$("");j("selected_title",e);const t=W();t.default&&(s.value=t.default().map(c=>{var l;return((l=c.props)==null?void 0:l.title)??"[Untitled]"}),e.value=s.value[0]);function o(c){return c===e.value?["tab","selected"]:["tab"]}function n(c){e.value=c}return(c,l)=>(E(),z(P,null,[A("div",te,[(E(!0),z(P,null,K(s.value,a=>(E(),z("div",{key:a,class:V(o(a)),onClick:r=>n(a)},J(a),11,se))),128))]),A("div",ne,[M(c.$slots,"default")])],64))}}),oe={class:"content vertical"},_e=X({__name:"TabContent",props:{title:{}},setup(i){const s=i,e=Q("selected_title");return(t,o)=>Z((E(),z("div",oe,[M(t.$slots,"default")],512)),[[p,s.title===ee(e)]])}});class ue extends d{constructor(){super(...arguments);T(this,"canvas")}setup(e){const{cell_size:t,rows:o,cols:n}=this.state,c=e.createCanvas(n*t,o*t);e.background(0),this.canvas=c.elt,d.show_canvas(c.elt)}can_edit(e){return this.state.editable_map?this.state.editable_map(e):!0}draw_term(e,t){const{cols:o,cell_size:n,coefficients:c}=this.state,l=n/4,{row:a,col:r}=t,u=a*o+r,h=c[u];if(!h)throw new Error(`The coefficients array has the incorrect number of terms! it must have ${this.state.rows*o}`);if(!this.can_edit(t)){e.fill(64),e.noStroke(),e.rect(r*n,a*n,n,n);return}const m=(a+.5)*n,v=(r+.5)*n;if(this.state.frequency_map){const x=this.state.frequency_map(t);let k,w;if(typeof x=="number"){const g=x;k=`${g}`,w=g}else{const{n:g,m:I}=x;k=`${g},${I}`,w=g-I}const y=.01*e.frameCount,S=.5*n*e.cos(w*y),C=.5*n*-e.sin(w*y);e.noFill(),e.stroke(255),e.line(v,m,v+S,m+C),e.noStroke(),e.fill(255),e.textSize(n/4),e.textAlign(e.RIGHT);const F=n/16;e.text(k,(r+1)*n-F,(a+1)*n-F)}e.stroke(255),e.noFill(),e.circle(v,m,2*l);const O=h&&h.r!==0,R=e.color(255,127,0),B=e.color(127);if(O){const{r:x,theta:k}=h,w=x*e.cos(k),y=x*-e.sin(k),S=v+w*l,C=m+y*l;e.stroke(R),e.noFill(),e.line(v,m,S,C),e.noStroke(),e.fill(R),e.circle(S,C,8)}else e.noStroke(),e.fill(B),e.circle(v,m,8)}draw(e){const{cell_size:t,rows:o,cols:n,selected_index:c}=this.state;e.background(0);for(let r=0;r<o;r++)for(let u=0;u<n;u++)this.draw_term(e,{row:r,col:u});e.push();const l=Math.floor(c/n),a=c%n;e.stroke(255,255,0),e.noFill(),e.rect(a*t,l*t,t,t),e.pop()}mouse_released(e){if(!this.canvas||!d.is_visible(this.canvas))return!0;const{cell_size:t,rows:o,cols:n,selected_index:c,coefficients:l}=this.state,a=Math.floor(e.mouseX/t),r=Math.floor(e.mouseY/t);if(a<0||a>=n||r<0||r>=o)return!0;if(!this.can_edit({row:r,col:a}))return!1;const u=r*n+a;if(u!==c){this.state.selected_index=u;const h=l[u];this.events.dispatchEvent(new CustomEvent("term-selected",{detail:h}))}return!1}}const D=400,_=D/2,U=4,f=U/2,b=D/U;function G(i){const{x:s,y:e}=i,t=(s-_)/b,o=-(e-_)/b;return new q(t,o)}function L(i){const{real:s,imag:e}=i,t=_+s*b,o=_-e*b;return{x:t,y:o}}function N(i){let{real:s,imag:e}=i;const t=4/b;s>f-t?s=f:s<-f+t&&(s=-f),e>f-t?e=f:e<-f+t&&(e=-f);const o=Math.sqrt(s*s+e*e);return o<=t&&(s=0,e=0),Math.abs(o-1)<=t&&(s/=o,e/=o),new q(s,e)}function ce(i){const s=G(i),e=N(s);return L(e)}class fe extends d{constructor(){super(...arguments);T(this,"canvas")}setup(e){const t=e.createCanvas(D,D);this.canvas=t.elt,d.show_canvas(t.elt)}draw(e){const{coefficient:t}=this.state;e.background(0),e.stroke(255),e.noFill(),e.circle(_,_,2*b);const{x:o,y:n}=L(t),c=e.color(255,127,0);e.stroke(c),e.noFill(),e.line(_,_,o,n),e.fill(c),e.noStroke(),e.circle(o,n,2*4),e.stroke(255),e.noFill();const{x:a,y:r}=ce({x:e.mouseX,y:e.mouseY});e.line(_,_,a,r)}emit_mouse_event(e,t){const o=e.mouseX,n=e.mouseY;if(o<0||o>=e.width||n<0||n>=e.height)return!0;const c=G({x:o,y:n}),l=N(c);return this.state.coefficient=l,this.events.dispatchEvent(new CustomEvent(t,{detail:l})),!1}mouse_released(e){return!this.canvas||!d.is_visible(this.canvas)?!0:this.emit_mouse_event(e,"change")}mouse_dragged(e){return!this.canvas||!d.is_visible(this.canvas)?!0:this.emit_mouse_event(e,"input")}}export{fe as C,ue as T,le as _,_e as a};
