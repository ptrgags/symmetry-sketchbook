var f=Object.defineProperty;var h=(o,e,r)=>e in o?f(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var _=(o,e,r)=>(h(o,typeof e!="symbol"?e+"":e,r),r);import{C as s,F as y}from"./ReferenceGeometryEditor.vue_vue_type_script_setup_true_lang-B8tEOrp8.js";import"./common_glsl-CLkdFb3a.js";import{S as c}from"./Sketch-D1HhKuvk.js";import{P as p}from"./PolynomialShader-rZ4bNzel.js";import{i as d,a as n}from"./validation-Cv0neZFQ.js";const i=[{id:"primary",label:"Primary Only",invert:!1,secondary_color:0},{id:"secondary-half",label:"Primary + secondary (halves)",invert:!1,secondary_color:1},{id:"secondary-alternate",label:"Primary + secondary (alternating)",invert:!1,secondary_color:2},{id:"secondary-circle",label:"Primary + secondary (inside circle)",invert:!1,secondary_color:3},{id:"invert-primary",label:"Inverted primary",invert:!0,secondary_color:0},{id:"invert-secondary-alternate",label:"Inverted primary + secondary (alternating)",invert:!0,secondary_color:2},{id:"invert-secondary-circle",label:"Inverted primary + secondary (circle)",invert:!0,secondary_color:3}];function v(){return{palette_type:i[0],primary_color:new s(.5,0,1),secondary_color:new s(.5,1,0),far_color:new s(0,0,0),far_power:4}}class S extends c{constructor(r){super(r);_(this,"shader");this.shader=new p(r.symmetry_mode)}setup(r){const t=r.createCanvas(500,700,r.WEBGL);c.show_canvas(t.elt),this.shader.init(r),this.shader.set_uniform("show_palette",!1),this.pattern=this.state.pattern,this.palette=this.state.palette,this.shader.disable()}draw(r){r.background(0),this.shader.draw(),this.shader.disable()}mouse_moved(r){const t=[r.mouseX/r.width,1-r.mouseY/r.height];return this.shader.set_mouse_uv(t),!1}set pattern(r){this.state.pattern=r,this.shader.set_coefficients(r.series),this.shader.set_uniform("rotation_order",r.rotation_order)}set show_palette(r){this.shader.set_uniform("show_palette",r)}set_color(r,t){this.shader.set_uniform(`${r}_color`,t.to_vec3())}set_xyrt_flags(r,t){this.shader.set_uniform(`${r}_xyrt`,t.map(Number))}set_thickness(r,t){this.shader.set_uniform(`${r}_thickness`,t)}set palette(r){this.state.palette=r,this.set_color("primary",r.primary_color),this.set_color("secondary",r.secondary_color),this.set_color("far",r.far_color),this.shader.set_uniform("invert_palette",r.palette_type.invert),this.shader.set_uniform("secondary_color_mode",r.palette_type.secondary_color),this.shader.set_uniform("far_power",r.far_power)}set ref_geom(r){for(const[t,a]of Object.entries(r))this.set_xyrt_flags(t,a.xyrt_flags),this.set_color(t,a.color),this.set_thickness(t,a.thickness)}}const l=new y;class g{serialize(e){return{series:l.serialize(e.series),rotation_order:e.rotation_order}}validate(e){return!(!d(e.rotation_order,"rotation_order")||!l.validate(e.series))}deserialize(e){return{series:l.deserialize(e.series),rotation_order:e.rotation_order}}}class E{serialize(e){return{palette_type:e.palette_type.id,primary_color:e.primary_color.to_hex(),secondary_color:e.secondary_color.to_hex(),far_color:e.far_color.to_hex(),far_power:e.far_power}}validate(e){if(!i.find(t=>t.id===e.palette_type)){const t=i.map(a=>a.id);return console.error(`invalid palette_type, valid values are: [${t.join(", ")}]`),!1}return!(!n(e.primary_color,"primary_color")||!n(e.secondary_color,"primary_color")||!n(e.far_color,"far_color")||!d(e.far_power,"far_power"))}deserialize(e){return{palette_type:i.find(r=>r.id===e.palette_type)??i[0],primary_color:s.from_hex(e.primary_color),secondary_color:s.from_hex(e.secondary_color),far_color:s.from_hex(e.far_color),far_power:e.far_power}}}export{g as P,E as a,S as b,i as c,v as d};
